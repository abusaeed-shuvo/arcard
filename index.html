<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>AR Business Card</title>
		<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
		<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
		<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
		<style>
			body {
				margin: 0;
				overflow: hidden;
				font-family: Arial, sans-serif;
			}

			#info {
				position: fixed;
				top: 10px;
				left: 10px;
				background: rgba(0, 0, 0, 0.85);
				color: white;
				padding: 15px;
				border-radius: 8px;
				z-index: 999;
				font-size: 12px;
				max-width: 320px;
			}

			#info h3 {
				margin: 0 0 10px 0;
				font-size: 14px;
				color: #4caf50;
			}

			#qualitySelector {
				margin-top: 10px;
				padding-top: 10px;
				border-top: 1px solid rgba(255, 255, 255, 0.2);
			}

			#qualitySelector select {
				width: 100%;
				padding: 5px;
				border-radius: 4px;
				background: rgba(255, 255, 255, 0.9);
				border: none;
				font-size: 11px;
				margin-top: 5px;
			}

			.status-line {
				margin: 5px 0;
				padding: 3px 0;
			}

			.status {
				color: #ffc107;
			}

			.success {
				color: #4caf50;
			}

			.error {
				color: #f44336;
			}

			#instructions {
				position: fixed;
				bottom: 20px;
				left: 50%;
				transform: translateX(-50%);
				background: rgba(0, 0, 0, 0.8);
				color: white;
				padding: 12px 24px;
				border-radius: 20px;
				z-index: 999;
				font-size: 13px;
				text-align: center;
			}

			.btn {
				background: #2196f3;
				color: white;
				border: none;
				padding: 8px 15px;
				border-radius: 5px;
				cursor: pointer;
				font-size: 11px;
				margin-top: 8px;
			}
		</style>
	</head>
	<body>
		<div id="info">
			<h3>ðŸŽ¯ AR Business Card</h3>
			<div class="status-line">
				Camera: <span id="cameraStatus" class="status">Starting...</span>
			</div>
			<div class="status-line">
				Marker: <span id="markerType" class="status">Custom Pattern</span>
			</div>
			<div class="status-line">
				Model: <span id="modelStatus" class="status">Loading...</span>
			</div>
			<div class="status-line">
				Detection: <span id="detectionStatus" class="status">Waiting...</span>
			</div>
			<div id="qualitySelector">
				<label style="font-size: 11px; opacity: 0.8">Camera Quality:</label>
				<select id="cameraQuality" onchange="changeCameraQuality()">
					<option value="640x480">SD - 640x480 (Fast)</option>
					<option value="1280x720">HD - 1280x720 (Balanced)</option>
					<option value="1280x960" selected>HD+ - 1280x960 (Better)</option>
					<option value="1920x1080">Full HD - 1920x1080 (Best)</option>
				</select>
				<div style="font-size: 10px; opacity: 0.7; margin-top: 5px">
					Note: Higher quality may be slower on some devices
				</div>
			</div>
			<button class="btn" onclick="location.reload()">ðŸ”„ Reload</button>
		</div>

		<div id="instructions">ðŸ“± Point camera at your custom marker</div>

		<a-scene
			embedded
			arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono; trackingMethod: best; sourceWidth: 1280; sourceHeight: 960; displayWidth: 1280; displayHeight: 960; videoTexture: true;"
			vr-mode-ui="enabled: false"
			renderer="colorManagement: true; physicallyCorrectLights: true; logarithmicDepthBuffer: true; antialias: true; precision: high;"
			loading-screen="enabled: false"
		>
			<a-assets>
				<!-- 
            ============================================
            IMPORTANT: UPDATE THESE PATHS!
            ============================================
            
            Option 1: Files in same repository
            Use relative paths:
            -->
				<a-asset-item id="customPattern" src="./markers/pattern-logo.patt">
				</a-asset-item>

				<a-asset-item id="businessModel" src="./models/business-model.glb">
				</a-asset-item>

				<!-- 
            Option 2: Files in GitHub (absolute URL)
            Replace 'username' and 'repo-name':
            
            <a-asset-item 
                id="customPattern" 
                src="https://username.github.io/repo-name/markers/pattern-logo.patt">
            </a-asset-item>
            
            <a-asset-item 
                id="businessModel" 
                src="https://username.github.io/repo-name/models/business-model.glb">
            </a-asset-item>
            -->

				<!-- 
            Option 3: Test with Hiro marker first
            Comment out the custom pattern above and uncomment this:
            
            <a-asset-item 
                id="hiroPattern" 
                src="https://raw.githubusercontent.com/AR-js-org/AR.js/master/data/data/patt.hiro">
            </a-asset-item>
            -->
			</a-assets>

			<!-- 
        ============================================
        MARKER CONFIGURATION
        ============================================
        
        For CUSTOM PATTERN marker (your logo):
        -->
			<a-marker
				type="pattern"
				url="./markers/pattern-logo.patt"
				id="marker"
				smoothCount="10"
				smoothTolerance="0.01"
				smoothThreshold="5"
			>
				<!-- 
        Alternative: For HIRO marker (testing):
        <a-marker preset="hiro" id="marker">
        -->

				<!-- 
        Alternative: For BARCODE marker:
        <a-marker type="barcode" value="7" id="marker">
        -->

				<!-- Card Platform -->
				<a-box
					position="0 0 0"
					width="2.2"
					height="0.06"
					depth="1.4"
					color="#ffffff"
					shadow="receive: true"
				>
				</a-box>

				<!-- Blue Accent Strip -->
				<a-box
					position="0 0.065 -0.65"
					width="2.2"
					height="0.015"
					depth="0.1"
					color="#2196F3"
				>
				</a-box>

				<!-- 3D Model (From Unreal or any GLB) -->
				<a-entity
					id="model3d"
					gltf-model="#businessModel"
					position="0 0.35 0"
					scale="0.4 0.4 0.4"
					rotation="0 0 0"
					animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear"
					shadow="cast: true"
				>
				</a-entity>

				<!-- Fallback Cube (if model fails to load) -->
				<a-box
					id="fallbackCube"
					position="0 0.35 0"
					rotation="0 45 0"
					scale="0.25 0.25 0.25"
					color="#2196F3"
					visible="false"
					animation="property: rotation; to: 0 405 0; loop: true; dur: 4000"
				>
				</a-box>

				<!-- Name -->
				<a-text
					value="JOHN DOE"
					align="center"
					color="#000000"
					width="3.5"
					position="0 0.07 0.62"
				>
				</a-text>

				<!-- Title -->
				<a-text
					value="Creative Developer"
					align="center"
					color="#666666"
					width="2.8"
					position="0 0.07 0.47"
				>
				</a-text>

				<!-- Email Button -->
				<a-plane
					position="-0.5 0.07 0.17"
					width="0.75"
					height="0.16"
					color="#4CAF50"
					id="emailBtn"
					class="clickable"
				>
					<a-text
						value="EMAIL"
						align="center"
						color="#ffffff"
						width="2.5"
						position="0 0 0.01"
					>
					</a-text>
				</a-plane>

				<!-- Website Button -->
				<a-plane
					position="0.5 0.07 0.17"
					width="0.75"
					height="0.16"
					color="#2196F3"
					id="webBtn"
					class="clickable"
				>
					<a-text
						value="WEBSITE"
						align="center"
						color="#ffffff"
						width="2.2"
						position="0 0 0.01"
					>
					</a-text>
				</a-plane>

				<!-- Contact Info -->
				<a-text
					value="+1 234 567 890"
					align="center"
					color="#333333"
					width="2.5"
					position="0 0.07 -0.08"
				>
				</a-text>

				<a-text
					value="john.doe@example.com"
					align="center"
					color="#333333"
					width="2"
					position="0 0.07 -0.26"
				>
				</a-text>

				<!-- Floating Particles -->
				<a-sphere
					position="0.9 0.5 0"
					radius="0.05"
					color="#FF5722"
					animation="property: position; to: 0.9 0.75 0; dir: alternate; loop: true; dur: 2000; easing: easeInOutSine"
				>
				</a-sphere>
				<a-sphere
					position="-0.9 0.5 0"
					radius="0.05"
					color="#FFC107"
					animation="property: position; to: -0.9 0.75 0; dir: alternate; loop: true; dur: 2300; easing: easeInOutSine"
				>
				</a-sphere>

				<!-- Lighting -->
				<a-light type="ambient" intensity="0.6"></a-light>
				<a-light
					type="directional"
					position="2 3 1"
					intensity="0.7"
					castShadow="true"
				></a-light>
				<a-light type="point" position="0 2 0" intensity="0.4"></a-light>
			</a-marker>

			<a-entity camera></a-entity>
		</a-scene>

		<script>
			// Status elements
			const cameraStatus = document.getElementById("cameraStatus");
			const markerType = document.getElementById("markerType");
			const modelStatus = document.getElementById("modelStatus");
			const detectionStatus = document.getElementById("detectionStatus");

			// Wait for page load
			window.addEventListener("load", () => {
				const scene = document.querySelector("a-scene");
				const marker = document.querySelector("#marker");
				const model = document.querySelector("#model3d");
				const fallback = document.querySelector("#fallbackCube");

				console.log("AR Scene initializing...");

				// Camera status
				navigator.mediaDevices
					.getUserMedia({ video: { facingMode: "environment" } })
					.then((stream) => {
						cameraStatus.textContent = "Active âœ“";
						cameraStatus.className = "success";
						stream.getTracks().forEach((track) => track.stop());
					})
					.catch((err) => {
						cameraStatus.textContent = "Failed âœ—";
						cameraStatus.className = "error";
						console.error("Camera error:", err);
					});

				// Scene loaded
				scene.addEventListener("loaded", () => {
					console.log("AR Scene loaded");
				});

				// Model loading
				if (model) {
					model.addEventListener("model-loaded", () => {
						console.log("âœ… 3D Model loaded successfully");
						modelStatus.textContent = "Loaded âœ“";
						modelStatus.className = "success";
						fallback.setAttribute("visible", "false");
					});

					model.addEventListener("model-error", (evt) => {
						console.error("âŒ Model loading failed:", evt.detail);
						modelStatus.textContent = "Failed (using fallback)";
						modelStatus.className = "error";
						fallback.setAttribute("visible", "true");
					});
				}

				// Marker detection
				if (marker) {
					marker.addEventListener("markerFound", () => {
						console.log("âœ… Marker detected!");
						detectionStatus.textContent = "Detected! ðŸŽ¯";
						detectionStatus.className = "success";
					});

					marker.addEventListener("markerLost", () => {
						console.log("âš ï¸ Marker lost");
						detectionStatus.textContent = "Searching...";
						detectionStatus.className = "status";
					});
				}

				// Button interactions
				setTimeout(() => {
					const emailBtn = document.querySelector("#emailBtn");
					const webBtn = document.querySelector("#webBtn");

					if (emailBtn) {
						emailBtn.addEventListener("click", () => {
							console.log("Email button clicked");
							window.location.href =
								"mailto:john.doe@example.com?subject=Hello%20from%20AR%20Card";
						});
					}

					if (webBtn) {
						webBtn.addEventListener("click", () => {
							console.log("Website button clicked");
							window.open("https://yourportfolio.com", "_blank");
						});
					}
				}, 2000);

				// Log paths for debugging
				console.log("Current page URL:", window.location.href);
				console.log("Base URL:", window.location.origin);
			});

			// Error logging
			window.addEventListener("error", (e) => {
				console.error("Page error:", e.error);
			});

			// Camera quality changer
			window.changeCameraQuality = function () {
				const quality = document.getElementById("cameraQuality").value;
				const [width, height] = quality.split("x");

				// Store selection
				localStorage.setItem("arCameraQuality", quality);

				// Update scene
				const scene = document.querySelector("a-scene");
				if (scene) {
					scene.setAttribute(
						"arjs",
						`sourceType: webcam; debugUIEnabled: false; detectionMode: mono; trackingMethod: best; sourceWidth: ${width}; sourceHeight: ${height}; displayWidth: ${width}; displayHeight: ${height}; videoTexture: true;`
					);
				}

				alert(
					`Camera quality changed to ${quality}\nReloading page for changes to take effect...`
				);
				location.reload();
			};

			// Load saved quality preference
			window.addEventListener("DOMContentLoaded", () => {
				const savedQuality = localStorage.getItem("arCameraQuality");
				if (savedQuality) {
					const selector = document.getElementById("cameraQuality");
					if (selector) {
						selector.value = savedQuality;
					}
				}
			});
		</script>
	</body>
</html>
