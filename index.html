<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>AR Business Card</title>
		<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
		<style>
			body {
				margin: 0;
				overflow: hidden;
			}

			#socialContainer {
				position: absolute;
				left: 50%;
				bottom: 10%;
				transform: translateX(-50%);
				display: flex;
				flex-direction: column;
				gap: 10px;
				padding: 10px 15px;
				border-radius: 15px;
				z-index: 10;
				align-items: center;
				justify-content: center;
				opacity: 0; /* hidden initially */
				pointer-events: auto;
				transition: opacity 0.3s ease;
				background-color: rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(6px);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
			}

			#socialContainer.show {
				opacity: 1;
			}

			/* Dark/light mode */
			@media (prefers-color-scheme: dark) {
				#socialContainer {
					background-color: rgba(255, 255, 255, 0.25);
				}
			}
			@media (prefers-color-scheme: light) {
				#socialContainer {
					background-color: rgba(0, 0, 0, 0.35);
				}
			}

			.row {
				display: flex;
				gap: 10px;
			}

			.social-icon {
				width: 50px;
				height: 50px;
				cursor: pointer;
				transition: transform 0.2s ease, opacity 0.2s ease;
			}

			.social-icon:hover {
				transform: scale(1.15);
				opacity: 0.9;
			}
		</style>
	</head>

	<body>
		<div id="socialContainer">
			<!-- First row -->
			<div class="row">
				<img id="facebookIcon" class="social-icon" src="./icons/facebook.png" />
				<img id="linkedinIcon" class="social-icon" src="./icons/linkedin.png" />
				<img id="whatsappIcon" class="social-icon" src="./icons/whatsapp.png" />
				<img id="locationIcon" class="social-icon" src="./icons/location.png" />
			</div>

			<!-- Second row -->
			<div class="row">
				<img id="phoneIcon" class="social-icon" src="./icons/call.png" />
				<img id="mailIcon" class="social-icon" src="./icons/mail.png" />
				<img id="websiteIcon" class="social-icon" src="./icons/web.png" />
				<img id="contactIcon" class="social-icon" src="./icons/contact.png" />
			</div>
		</div>
		<a-scene
			mindar-image="imageTargetSrc: https://abusaeed-shuvo.github.io/arcard/targets/targets.mind; 
                     uiLoading: false; 
                     uiScanning: false;"
			color-space="sRGB"
			renderer="colorManagement: true, physicallyCorrectLights"
			vr-mode-ui="enabled: false"
			device-orientation-permission-ui="enabled: false"
		>
			<a-assets>
				<img
					id="cardPNG"
					src="https://abusaeed-shuvo.github.io/arcard/img/bc1.png"
				/>

				<video
					id="introVideo"
					src="https://abusaeed-shuvo.github.io/arcard/videos/intro.mp4"
					loop
					muted
					playsinline
					crossorigin="anonymous"
				></video>
			</a-assets>

			<a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

			<!-- AR Target -->
			<a-entity
				mindar-image-target="targetIndex: 0"
				animation__smoothpos="property: position; dur: 200; easing: easeOutQuad"
				animation__smoothrot="property: rotation; dur: 200; easing: easeOutQuad"
			>
				<!-- CardPNG -->

				<a-plane
					src="#cardPNG"
					width="1"
					height="0.5"
					position="0 0.8 0.05"
					rotation="0 0 0"
					material="transparent: true"
				></a-plane>

				<!-- Intro Video -->
				<a-video
					src="#introVideo"
					position="0 -1.8 0"
					width="1.6"
					height="9"
					rotation="0 0 0"
					material="shader: flat;"
				></a-video>
			</a-entity>
		</a-scene>

		<script>
			AFRAME.registerComponent("responsive-scale", {
				schema: { base: { default: 1 } },
				init() {
					const el = this.el;
					const mindarTarget = el.closest("[mindar-image-target]");
					const baseScale = this.data.base;
					const resize = () => {
						const aspect = window.innerWidth / window.innerHeight;
						// scale to keep proportions roughly screen-based
						const scale =
							baseScale * (aspect > 1 ? aspect / 1.5 : 1.5 / aspect);
						el.object3D.scale.set(scale, scale, scale);
					};
					window.addEventListener("resize", resize);
					resize();

					// if you only want scaling when visible:
					mindarTarget.addEventListener("targetFound", resize);
				},
			});

			const videoEl = document.getElementById("introVideo");
			const socialContainer = document.getElementById("socialContainer");
			const target = document.querySelector("[mindar-image-target]");

			// Show/hide social icons with fade effect
			target.addEventListener("targetFound", () => {
				socialContainer.classList.add("show");
				setTimeout(() => videoEl.play(), 200);
			});
			target.addEventListener("targetLost", () => {
				socialContainer.classList.remove("show");
			});

			// Social icon click/tap events
			const actions = {
				facebookIcon: () =>
					window.open("https://www.facebook.com/yourusername", "_blank"),
				linkedinIcon: () =>
					window.open("https://www.linkedin.com/in/yourusername", "_blank"),
				whatsappIcon: () =>
					window.open("https://wa.me/8801234567890", "_blank"),
				locationIcon: () =>
					window.open(
						"https://www.google.com/maps?q=123+Main+Street,+City",
						"_blank"
					),
				phoneIcon: () => (window.location.href = "tel:+8801234567890"),
				mailIcon: () => (window.location.href = "mailto:youremail@example.com"),
				websiteIcon: () => window.open("https://www.yourwebsite.com", "_blank"),
				contactIcon: () => window.open("./my-contact.vcf", "_blank"),
			};
			// Attach both click and touchstart for mobile
			Object.keys(actions).forEach((id) => {
				const el = document.getElementById(id);
				el.addEventListener("click", actions[id]);
				el.addEventListener("touchstart", actions[id]);
			});
		</script>
	</body>
</html>
